#!php
<?php

$home = $_SERVER["HOME"];

$sublimeConfigPath = createPath([$home, "Library", "Application Support", "Sublime Text", "Packages"]);
$sublimeConfigPathActual = createPath([$sublimeConfigPath, "User"]);
$sublimeConfigHere = createPath([__DIR__, "User"]);

if (!is_link($sublimeConfigPathActual)) {
	info("Backing up the current config...");
	rename($sublimeConfigPathActual, $sublimeConfigPathActual . 'Bkp');
	exec("ln -s \"$sublimeConfigHere\" \"$sublimeConfigPathActual\"");
	info("Sublime config linked.");
} else {
	info("Skipping sublime config...");
}

function createPath(array $paths): string
{
	return implode(DIRECTORY_SEPARATOR, $paths);
}

function info(string $message): void
{
	echo "INFO: $message" . PHP_EOL;
}
